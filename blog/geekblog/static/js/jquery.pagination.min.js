(function(b,a,c){b.Slider=function(e,d){this.$el=d;this.value=e.value;this.total=e.total;this.width=e.width;this._create()};b.Slider.prototype={_create:function(){var d=this;this.slider=this.$el.slider({value:this.value,min:1,max:this.total,step:1});this.$value=b("<span>"+this.value+"</span>");this.getHandle().append(this.$value)},setValue:function(d){this.value=d;this.$value.text(d);this.slider.slider("value",d)},getValue:function(){return this.value},getHandle:function(){return this.$el.find("a.ui-slider-handle")},getSlider:function(){return this.slider},getSliderEl:function(){return this.$el},next:function(d){if(this.value<this.total){this.setValue(++this.value);if(d){d.call(this,this.value)}}},previous:function(d){if(this.value>1){this.setValue(--this.value);if(d){d.call(this,this.value)}}}};b.Pagination=function(d,e){this.$el=b(e);this._init(d)};b.Pagination.defaults={value:1,total:5,width:200,onChange:function(d){return false},onSlide:function(d){return false}};b.Pagination.prototype={_init:function(d){this.options=b.extend(true,{},b.Pagination.defaults,d);var e={"WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd","msTransition":"MSTransitionEnd","transition":"transitionend"};this.transEndEventName=e[Modernizr.prefixed("transition")];b.fn.applyStyle=Modernizr.csstransitions?b.fn.css:b.fn.animate;this._layout();this._initEvents()},_layout:function(){this.$navNext=this.$el.find("nav > a.sp-next");this.$navPrev=this.$el.find("nav > a.sp-prev");var d=b('<div class="sp-slider"></div>').appendTo(this.$el);this.slider=new b.Slider({value:this.options.value,total:this.options.total,width:this.options.width},d);this.isSliderOpened=false},_initEvents:function(){var d=this;this.slider.getHandle().on("click",function(){if(d.isSliderOpened){return false}d.isSliderOpened=true;d.slider.getSliderEl().addClass("sp-slider-open");d.$el.stop().applyStyle({width:d.options.width},b.extend(true,[],{duration:"150ms"}));d.toggleNavigation(false);return false});this.slider.getSlider().on({"slidestop":function(e,f){if(!d.isSliderOpened){return false}var g=function(){d.isSliderOpened=false;d.slider.getSliderEl().removeClass("sp-slider-open");d.toggleNavigation(true)};d.$el.stop().applyStyle({width:0},b.extend(true,[],{duration:"150ms",complete:g})).on(d.transEndEventName,function(){b(this).off(d.transEndEventName);g.call()});d.options.onChange(f.value)},"slide":function(e,f){if(!d.isSliderOpened){return false}d.slider.setValue(f.value);d.options.onSlide(f.value)}});this.$navNext.on("click",function(){d.slider.next(function(e){d.options.onChange(e)});return false});this.$navPrev.on("click",function(){d.slider.previous(function(e){d.options.onChange(e)});return false})},toggleNavigation:function(d){b.fn.render=d?b.fn.show:b.fn.hide;this.$navNext.render();this.$navPrev.render()}};b.fn.pagination=function(f){var d=b.data(this,"pagination");if(typeof f==="string"){var e=Array.prototype.slice.call(arguments,1);this.each(function(){d[f].apply(d,e)})}else{this.each(function(){d?d._init():d=b.data(this,"pagination",new b.Pagination(f,this))})}return d}})(jQuery,window);
